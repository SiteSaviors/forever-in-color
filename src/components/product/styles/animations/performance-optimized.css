/* Phase 2: Performance-Optimized Animation System */

/* Core performance principles:
   1. Minimal will-change usage - only when actively animating
   2. GPU acceleration through transform3d
   3. Contain layout/style/paint where appropriate
   4. Reduce motion support for accessibility
   5. Mobile-specific optimizations
*/

/* Animation Registry - Centralized keyframes */
@keyframes accordion-expand-optimized {
  from {
    height: 0;
    opacity: 0;
    transform: translate3d(0, -10px, 0);
  }
  to {
    height: var(--radix-accordion-content-height);
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

@keyframes accordion-collapse-optimized {
  from {
    height: var(--radix-accordion-content-height);
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
  to {
    height: 0;
    opacity: 0;
    transform: translate3d(0, -10px, 0);
  }
}

@keyframes step-activation {
  from {
    transform: translate3d(0, 0, 0) scale3d(0.98, 0.98, 1);
    opacity: 0.8;
  }
  to {
    transform: translate3d(0, 0, 0) scale3d(1, 1, 1);
    opacity: 1;
  }
}

@keyframes interaction-feedback {
  0% {
    transform: translate3d(0, 0, 0) scale3d(1, 1, 1);
  }
  50% {
    transform: translate3d(0, -2px, 0) scale3d(1.02, 1.02, 1);
  }
  100% {
    transform: translate3d(0, 0, 0) scale3d(1, 1, 1);
  }
}

@keyframes gentle-pulse {
  0%, 100% {
    transform: translate3d(0, 0, 0);
    opacity: 1;
  }
  50% {
    transform: translate3d(0, -1px, 0);
    opacity: 0.9;
  }
}

/* Performance-optimized base classes */
.perf-base {
  /* Only enable will-change when actively animating */
  will-change: auto;
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
}

.perf-animating {
  will-change: transform, opacity;
}

.perf-container {
  contain: layout style;
  transform: translate3d(0, 0, 0);
}

.perf-paint-container {
  contain: layout style paint;
  transform: translate3d(0, 0, 0);
}

/* Accordion-specific optimizations */
.accordion-item-optimized {
  @apply perf-container;
  transition: box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.accordion-item-optimized.is-active {
  @apply perf-animating;
  animation: step-activation 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.accordion-item-optimized.is-interactive:hover {
  @apply perf-animating;
  animation: interaction-feedback 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.accordion-content-optimized {
  @apply perf-base;
  animation-duration: 0.25s;
  animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  animation-fill-mode: forwards;
}

.accordion-content-optimized[data-state="open"] {
  @apply perf-animating;
  animation-name: accordion-expand-optimized;
}

.accordion-content-optimized[data-state="closed"] {
  @apply perf-animating;
  animation-name: accordion-collapse-optimized;
}

.accordion-trigger-optimized {
  @apply perf-base;
  transition: transform 0.15s cubic-bezier(0.4, 0, 0.2, 1);
}

.accordion-trigger-optimized:hover {
  transform: translate3d(0, -1px, 0);
}

.accordion-trigger-optimized:active {
  transform: translate3d(0, 0, 0);
}

/* Chevron rotation optimization */
.chevron-optimized {
  @apply perf-base;
  transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.chevron-optimized.is-open {
  transform: translate3d(0, 0, 0) rotate(180deg);
}

/* Step indicator optimizations */
.step-indicator-optimized {
  @apply perf-base;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.step-indicator-optimized.is-completed {
  @apply perf-animating;
  animation: gentle-pulse 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Loading state optimizations */
.loading-skeleton-optimized {
  @apply perf-paint-container;
  background: linear-gradient(90deg, 
    transparent 25%, 
    rgba(255, 255, 255, 0.1) 50%, 
    transparent 75%
  );
  background-size: 200% 100%;
  animation: shimmer-optimized 1.5s infinite;
}

@keyframes shimmer-optimized {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

/* Error state animations */
.error-shake-optimized {
  @apply perf-animating;
  animation: error-shake 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes error-shake {
  0%, 100% {
    transform: translate3d(0, 0, 0);
  }
  25% {
    transform: translate3d(-4px, 0, 0);
  }
  75% {
    transform: translate3d(4px, 0, 0);
  }
}

/* Mobile optimizations */
@media (max-width: 768px) {
  .accordion-item-optimized.is-active {
    animation-duration: 0.2s;
  }
  
  .accordion-content-optimized {
    animation-duration: 0.2s;
  }
  
  .accordion-trigger-optimized:hover {
    transform: none; /* Disable hover effects on mobile */
  }
}

/* Tablet optimizations */
@media (min-width: 769px) and (max-width: 1024px) {
  .accordion-item-optimized {
    contain: layout style; /* Reduced containment for tablets */
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  .perf-base,
  .perf-animating,
  .accordion-item-optimized,
  .accordion-content-optimized,
  .accordion-trigger-optimized,
  .chevron-optimized,
  .step-indicator-optimized,
  .loading-skeleton-optimized {
    will-change: auto;
    animation: none !important;
    transition: none !important;
  }
  
  .chevron-optimized.is-open {
    transform: rotate(180deg);
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .accordion-item-optimized {
    border: 2px solid;
  }
  
  .step-indicator-optimized {
    border: 2px solid;
  }
}
